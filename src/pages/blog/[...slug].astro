---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const base = import.meta.env.BASE_URL;

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: post,
	}));
}

const post = Astro.props;
const { Content } = await post.render();
---

<Layout title={post.data.title} description={post.data.description}>
	<article class="max-w-3xl mx-auto">
        <a href={`${base}blog`} class="text-pink-600 hover:underline mb-6 inline-block">&larr; Zpět na blog</a>
        
        <header class="mb-8 text-center">
            <h1 class="text-3xl md:text-4xl font-bold mb-4 text-stone-900">{post.data.title}</h1>
            <div class="flex items-center justify-center gap-4 text-stone-500 text-sm">
                <time datetime={post.data.pubDate.toISOString()}>{post.data.pubDate.toLocaleDateString('cs-CZ')}</time>
                {post.data.author && <span>• {post.data.author}</span>}
            </div>
        </header>

        {post.data.heroImage && (
            <img 
                src={post.data.heroImage} 
                alt={post.data.title} 
                class="rounded-xl shadow-md mb-8 w-full object-cover max-h-[400px]" 
                loading="lazy"
            />
        )}
        
        {post.data.externalLink && (
            <div class="bg-gradient-to-r from-pink-50 to-stone-50 border border-pink-100 p-6 rounded-xl mb-8 text-center">
                <p class="mb-4 font-medium text-rose-800">Tento článek pokračuje na externím webu:</p>
                <a 
                    href={post.data.externalLink} 
                    target="_blank" 
                    rel="noopener noreferrer" 
                    class="inline-block bg-pink-600 text-white px-8 py-3 rounded-full hover:bg-pink-700 transition font-medium focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2"
                >
                    Číst celý článek na Kamdu.cz &rarr;
                </a>
            </div>
        )}

        <div class="prose prose-stone prose-pink lg:prose-lg max-w-none">
		    <Content />
        </div>
	</article>
</Layout>
